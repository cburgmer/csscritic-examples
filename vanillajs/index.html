<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CSS Critic Examples by cburgmer</title>

    <link rel="stylesheet" href="../stylesheets/styles.css">
    <link rel="stylesheet" href="../stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <link rel="stylesheet" href="../stylesheets/examples.css">

    <link rel="stylesheet" type="text/css" href="bower_components/csscritic/dist/csscritic.min.css">
    <script type="text/javascript" src="bower_components/csscritic/dist/csscritic.allinone.js"></script>

    <script type="text/javascript">
        window.onload = function() {
            csscritic.addReporter(csscritic.BasicHTMLReporter());
            csscritic.add('test/ui/vanilla_initial_view.html');
            csscritic.add('test/ui/vanilla_single_active_entry.html');
            csscritic.add('test/ui/vanilla_single_completed_entry.html');
            csscritic.add('test/ui/vanilla_multiple_entries.html');
            csscritic.add('test/ui/vanilla_footer_active_view.html');
            csscritic.add('test/ui/vanilla_footer_clear_completed.html');
            csscritic.add('test/ui/vanilla_footer_one_entry_left.html');
            csscritic.add('test/ui/vanilla_footer_two_entries_left.html');
            csscritic.execute();
        };
    </script>
  </head>
  <body>
    <div class="wrapper">
      <div id="csscritic_basichtmlreporter"></div>
<article class="markdown-body entry-content" itemprop="mainContentOfPage"><h1>
<a name="user-content-vanilla-js" class="anchor" href="#vanilla-js"><span class="octicon octicon-link"></span></a>Vanilla JS</h1>

<p>This is a pure JavaScript application based on the <a href="https://github.com/tastejs/todomvc/tree/gh-pages/vanilla-examples/vanillajs">TodoMVC implementation</a>.</p>

<h1>
<a name="user-content-get-started" class="anchor" href="#get-started"><span class="octicon octicon-link"></span></a>Get started</h1>

<p>See the <a href="https://github.com/cburgmer/csscritic-examples/blob/master/vanillajs/RegressionRunner.html">visual regression test suite</a> and <a href="https://github.com/cburgmer/csscritic-examples/blob/master/vanillajs/test/ui">all test cases</a>.</p>

<p>Launch <a href="https://github.com/cburgmer/csscritic-examples/blob/master/vanillajs/src/index.html"><code>src/index.html</code></a> to open the application.</p>

<h1>
<a name="user-content-what-is-to-see-here" class="anchor" href="#what-is-to-see-here"><span class="octicon octicon-link"></span></a>What is to see here?</h1>

<p>Looking at <a href="https://github.com/cburgmer/csscritic-examples/blob/master/vanillajs/test/ui/single_active_entry.html"><code>test/ui/single_active_entry.html</code></a> you'll see a test case includes</p>

<ul>
<li>linked CSS under test,</li>
<li>some HTML mimicing the production environment,</li>
<li>the application's JavaScript dependencies, and</li>
<li>initializing code to manipulate the view for the desired test.</li>
</ul><h2>
<a name="user-content-dynamic-view" class="anchor" href="#dynamic-view"><span class="octicon octicon-link"></span></a>Dynamic view</h2>

<p>Most views out there need JavaScript to manipulate the DOM structure from the plain HTML page. Triggering this in tests can be made straightforward if you <a href="http://martinfowler.com/bliki/PresentationDomainSeparation.html">separate the DOM from your business logic</a>. The TodoMVC application has been refactored to follow this principle and so the view here can be easily executed. The controller or persistance layer is not needed in the tests.</p>

<p>Test case <a href="https://github.com/cburgmer/csscritic-examples/blob/master/vanillajs/test/ui/vanilla_single_active_entry.html"><code>test/ui/vanilla_single_active_entry.html</code></a> shows a manipulated view object which is being passed an active entry, that is then reflected in the DOM.</p>

<div class="highlight highlight-js"><pre><span class="kd">var</span> <span class="nx">template</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">Template</span><span class="p">(),</span>
    <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">app</span><span class="p">.</span><span class="nx">View</span><span class="p">(</span><span class="nx">template</span><span class="p">);</span>

<span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'showEntries'</span><span class="p">,</span> <span class="p">[{</span>
    <span class="nx">title</span><span class="o">:</span> <span class="s1">'an active entry'</span><span class="p">,</span>
    <span class="nx">completed</span><span class="o">:</span> <span class="kc">false</span>
<span class="p">}]);</span>

</pre></div>

<h2>
<a name="user-content-a-word-on-the-html" class="anchor" href="#a-word-on-the-html"><span class="octicon octicon-link"></span></a>A word on the HTML</h2>

<p>Testing your CSS is only meaningful if integrated with your HTML structure. If you have some static HTML but no client-side template loading mechanism (just like the vanilla application here), then there's a challenge in getting your production code into the test.</p>

<p>For the sake of simplicity we just create a test fixture (copying the parts under test from production code). Start with this approach yourself if you want. However, your tests will be much more meaningful if you are able to test the actual production HTML. One way of achieving this is introducing a templating system that allows partials that can then be independently tested.</p>

<h2>
<a name="user-content-wiring-together" class="anchor" href="#wiring-together"><span class="octicon octicon-link"></span></a>Wiring together</h2>

<p>The browsers limit the paths accessible out of same-origin restrictions. This makes wiring up the test suite a tiny bit more complicated. Let's look at <a href="https://github.com/cburgmer/csscritic-examples/blob/master/vanillajs/test/ui/vanilla_single_active_entry.html"><code>test/ui/vanilla_single_active_entry.html</code></a> for example. While the document sits under <code>test/ui/</code> the application is found under <code>../../src/</code> relativly from there. If we linked like that, Firefox would complain about accessing a restricted path. Instead we apply a small tweak. We create a symbolic link in the <code>test/ui/</code> directory via</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>ln -s ../../src <span class="nb">test</span>/ui/src
</pre></div>

<p>from the project's root directory and link to <code>src/</code> inside the document. This allows us to write the following:</p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"src/base.css"</span><span class="nt">&gt;</span>
</pre></div>

<p>If the <code>RegressionRunner.html</code> file is served through a (local) web-server, this will not be an issue whatsoever.</p></article>
    </div>
    <script src="../javascripts/scale.fix.js"></script>

  </body>
</html>
